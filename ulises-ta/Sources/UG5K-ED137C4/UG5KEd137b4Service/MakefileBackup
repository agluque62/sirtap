################################################################
.SILENT:
SHELL     := /bin/bash

################################################################
## Colordefinition
################################################################
NO_COLOR    = \x1b[0m
OK_COLOR    = \x1b[32;01m
WARN_COLOR  = \x1b[33;01m
ERROR_COLOR = \x1b[31;01m
################################################################

OBJS = UG5KEd137b4Service.o MiSocket.o NLOG.o RTPSession.o RTSPSession.o RTSPMessages.o stlini.o Thread.o Timer.o UG5KRecordService.o Utilidades.o LocalConfig.o buildstring.o

CC	= $(CROSS_COMPILE)gcc
CFLAGS	=-Wall -ggdb 
LIBS	=-lpthread -lstdc++
LDFLAGS	=

all: ug5krec

buildstring.o:
	date '+char acBuildString[] = "NUCLEODF %F %H:%M:%S";' > ./buildstring.cxx
	$(CC) -c $(CFLAGS) ./buildstring.cxx -o ./buildstring.o

%.o: %.cpp
	# @echo --------------------------------------------------------------------------------
	echo  -e "$(WARN_COLOR)-- $(CROSS_COMPILE) Compiling $<$(NO_COLOR)"
	# @echo --------------------------------------------------------------------------------
	$(CC) -c $(CFLAGS) $< -o $@


ug5krec: $(OBJS)
	# @echo --------------------------------------------------------------------------------
	echo   -e "$(OK_COLOR)-- Linking $@$(NO_COLOR)"
	# @echo --------------------------------------------------------------------------------
	$(CC) $(LIBS) $(LDFLAGS) -o $@ $(OBJS)
	$(CROSS_COMPILE)strip ug5krec
	# @echo --------------------------------------------------------------------------------

clean:
	echo  -e "$(ERROR_COLOR)-- Eliminando Ficheros objeto...$(NO_COLOR)"
	rm -r *.o

